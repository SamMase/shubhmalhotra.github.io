function broadcastPlayerState(e){if(e!=null){var t=new currentStatePayload(e);var n=new broadcast(STATUS_CODE_OK,t);var r=JSON.stringify(n);log(r);broadcastMessage(r)}}function broadcastCurrentPosition(e){var t=new broadcast(STATUS_CODE_OK,e);broadcastMessage(JSON.stringify(t))}function broadcastCurrentMetadata(e){if(e!=null){var t=new currentMetadataPayload(e);var n=JSON.stringify(new broadcast(STATUS_CODE_OK,t));log(n);broadcastMessage(n);broadcastCurrentPosition(new currentPositionPayload(0,0))}}function broadcastCurrentQueue(e){if(e!=null){var t=new currentQueuePayload(e);var n=JSON.stringify(new broadcast(STATUS_CODE_OK,t));broadcastMessage(n)}}function broadcastCurrentYoutubeQuality(e){if(e!=null){var t=new currentYoutubeQualityPayload(e);var n=JSON.stringify(new broadcast(STATUS_CODE_OK,t));broadcastMessage(n)}}function broadcast(e,t){this.type=RESPONSE_TYPE_BROADCAST;this.version=TEEWE_CC_API_VERSION;this.status_code=e;this.payload=t}function response(){}function currentPositionPayload(e,t){this.broadcast_type=BROADCAST_CURRENT_POSITION;this.payload={current_position:{position:e,total_duration:t}}}function currentMetadataPayload(e){this.broadcast_type=BROADCAST_NOW_PLAYING;this.payload={mediaitem:e}}function currentStatePayload(e){this.broadcast_type=BROADCAST_CURRENT_STATE;this.payload={state:e}}function currentQueuePayload(e){this.broadcast_type=BROADCAST_QUEUE_UPDATED;this.payload={current_queue:e}}function currentYoutubeQualityPayload(e){this.broadcast_type=BROADCAST_YOUTUBE_QUALITY;this.payload={youtube_quality:e}}function startDurationTimer(){if(durationTimer!=false){stopDurationTimer()}durationTimer=setInterval(function(){var e=getCurrentPositionInSeconds();var t=getTotalDurationInSeconds();broadcastCurrentPosition(new currentPositionPayload(e,t));if(globalCurrentMedia!=null&&globalCurrentMedia.type==AUDIO_TYPE){updateProgressDiv(e,t)}},1e3)}function stopDurationTimer(){if(durationTimer!=false){window.clearInterval(durationTimer);duration=false}}function setCurrentMediaplayer(e){log("Setting current media player to : "+e);var t=[YOUTUBE_PLAYER,VIDEO_PLAYER,AUDIO_PLAYER,IMAGE_PLAYER,NONE];if(t.indexOf(e)!=-1){CURRENT_MEDIA_PLAYER=e}else{CURRENT_MEDIA_PLAYER=NONE}}function setAndBroadcastPlayerState(e){log(e);var t=[STATE_NO_MEDIA,STATE_PLAYING,STATE_PAUSED,STATE_STOPPED,STATE_LOADING];if(t.indexOf(e)!=-1){globalPlayerState=e;if(globalPlayerState==STATE_PLAYING&&globalCurrentMedia.type!=IMAGE_TYPE){startDurationTimer()}else{stopDurationTimer()}}else{log("Invalid state : "+e);globalPlayerState=STATE_STOPPED}if(globalCurrentMedia!=null&&globalCurrentMedia.type==AUDIO_TYPE){updateAudioState(globalPlayerState)}broadcastPlayerState(globalPlayerState);if(globalPlayerState==STATE_STOPPED){broadcastCurrentPosition(new currentPositionPayload(0,0))}}function getCurrentPositionInSeconds(){var e;if(globalCurrentMedia!=null){switch(globalCurrentMedia.type){case YOUTUBE_TYPE:e=teeweYoutubePlayer.getCurrentPosition();break;case VIDEO_TYPE:e=teeweVideoPlayer.getCurrentPosition();break;case AUDIO_TYPE:e=teeweVideoPlayer.getCurrentPosition();break;case IMAGE_TYPE:break;default:break}if(e==null)e=0;return Math.round(e)}}function getTotalDurationInSeconds(){var e;if(globalCurrentMedia!=null){switch(globalCurrentMedia.type){case YOUTUBE_TYPE:e=teeweYoutubePlayer.duration();break;case VIDEO_TYPE:e=teeweVideoPlayer.duration();break;case AUDIO_TYPE:e=teeweVideoPlayer.duration();break;case IMAGE_TYPE:break;default:break}if(e==null)e=0;return Math.round(e)}}function setNowPlaying(e){globalCurrentMedia=e;current_queue_index=getIndexOf(globalCurrentMedia);broadcastCurrentMetadata(globalCurrentMedia);log("Setting now playing index to "+current_queue_index);log("Setting now playing item to "+globalCurrentMedia.title)}function loadItem(e,t){var n=e.type;log("media type is : "+n);log("Loading item of type : "+e.type_string);if(t){log("Adding to queue : "+e.title);var r=getCurrentPlayingIndex();if(r==-1){addToQueueLast(e)}else{addToQueueAtPosition(r+1,e)}}else{log("Not adding to queue : "+e.title)}setNowPlaying(e);clearErrorTimeout();log("Current mediaplayer is : "+CURRENT_MEDIA_PLAYER);switch(n){case YOUTUBE_TYPE:if(CURRENT_MEDIA_PLAYER!=YOUTUBE_PLAYER)stopAllMedia();teeweYoutubePlayer.loadVideo(e);break;case VIDEO_TYPE:if(CURRENT_MEDIA_PLAYER!=VIDEO_PLAYER)stopAllMedia();teeweVideoPlayer.loadVideo(e);break;case AUDIO_TYPE:if(CURRENT_MEDIA_PLAYER!=VIDEO_PLAYER)stopAllMedia();teeweVideoPlayer.loadVideo(e);break;case IMAGE_TYPE:if(CURRENT_MEDIA_PLAYER!=IMAGE_PLAYER)stopAllMedia();teeweImageViewer.loadImage(e);break;default:log("No case matched")}}function stopMedia(){stopAllMedia()}function stopAllMedia(){if(document.getElementById("video-player")!=null){teeweVideoPlayer.stop()}if(document.getElementById("youtube-player")!=null){teeweYoutubePlayer.stop()}if(document.getElementById("image-viewer-div")!=null){teeweImageViewer.stop()}setCurrentMediaplayer(NONE)}function pauseMedia(){if(globalCurrentMedia!=null){switch(globalCurrentMedia.type){case YOUTUBE_TYPE:teeweYoutubePlayer.pause();break;case VIDEO_TYPE:teeweVideoPlayer.pause();break;case AUDIO_TYPE:teeweVideoPlayer.pause();break;case IMAGE_TYPE:break;default:break}}}function seekMedia(e){if(globalCurrentMedia!=null){switch(globalCurrentMedia.type){case YOUTUBE_TYPE:teeweYoutubePlayer.seek(e);break;case VIDEO_TYPE:teeweVideoPlayer.seek(e);break;case AUDIO_TYPE:teeweVideoPlayer.seek(e);break;case IMAGE_TYPE:break;default:break}}}function playMedia(){if(globalCurrentMedia!=null){if(globalPlayerState==STATE_STOPPED){loadItem(globalCurrentMedia,false);return}switch(globalCurrentMedia.type){case YOUTUBE_TYPE:teeweYoutubePlayer.play();break;case VIDEO_TYPE:teeweVideoPlayer.play();break;case AUDIO_TYPE:teeweVideoPlayer.play();break;case IMAGE_TYPE:break;default:break}}}function goNext(){var e=getIndexOfNextItem();if(e<0){log("There is no next item to be played")}else{var t=getItemAtPosition(e);if(t!=null){log("Next item to be played is : "+t.title);loadItem(t,false)}else{log("Couldn't fetch item at : "+e)}}}function goPrevious(){var e=getIndexOfPreviousItem();if(e==-1){log("There is no item to be played")}else{var t=getItemAtPosition(e);if(t!=null){log("Previous item to be played is : "+t.title);loadItem(t,false)}else{log("Couldn't fetch item at : "+e)}}}function playbackEnded(){if(getIndexOfNextItem()==-2){queuePlaybackEnded()}else{goNext()}}function queuePlaybackEnded(){log("Queue Playback Finished");stopMedia()}function loadItemMultiple(e,t){}function clearErrorTimeout(){if(errorTimeout!=false){clearTimeout(errorTimeout);errorTimeout=false}}function addToQueueAtPosition(e,t){if(e<0||t==null)return;if(!(t.unique_id in queueMap)){queueMap[t.unique_id]=t;queueOrder.splice(e,0,t.unique_id);log(queueOrder.join("</br>"));log(JSON.stringify(queueMap));broadcastCurrentQueue(getQueue())}else{log("Item already in queue : "+t.title)}}function addToQueueLast(e){addToQueueAtPosition(queueOrder.length,e)}function addToQueueMultipleAtPosition(e,t){if(e<0||t==null)return;var n=[];for(var r=0;r<t.length;r++){if(!(t[r].unique_id in queueMap)){queueMap[t[r].unique_id]=t[r];n.push(t[r].unique_id)}}if(n.length!=0){for(var r=0;r<n.length;r++){queueOrder.splice(e+r,0,n[r])}broadcastCurrentQueue(getQueue())}}function addToQueueMultipleLast(e){addToQueueMultipleAtPosition(queueOrder.length,e)}function removeItemFromQueue(e){if(e==null||queueOrder.length==0)return;if(e.unique_id in queueMap){delete queueMap[e.unique_id];queueOrder.splice(queueOrder.indexOf(e.unique_id),1);log("Item deleted from queue : "+e.unique_id);broadcastCurrentQueue(getQueue())}else{log("Can't find this item in queue : "+e.unique_id)}}function removeIndexFromQueue(e){if(queueOrder.length!=0&&e>=0&&e<queueOrder.length){removeItemFromQueue(queueMap[queueOrder[e]])}}function clearQueue(){if(queueOrder.length!=0){queueOrder=[];queueMap={};broadcastCurrentQueue(getQueue())}}function getIndexOf(e){if(e==null||e.unique_id==null)return-1;return queueOrder.indexOf(e.unique_id)}function getCurrentPlayingIndex(){return getIndexOf(globalCurrentMedia)}function getItemAtPosition(e){if(queueOrder.length!=0&&e>=0&&e<queueOrder.length){return queueMap[queueOrder[e]]}}function getQueue(){var e=[];for(var t=0;t<queueOrder.length;t++){e.push(getItemAtPosition(t))}return e}function getCurrentQueueLength(){return queueOrder.length}function getIndexOfNextItem(){if(getCurrentQueueLength()==0){log("Can't go next in an empty queue");return-1}var e=getIndexOf(globalCurrentMedia);var t=e+1;if(e==-1){log("Current playing item is not in list, current_queue_index is :"+current_queue_index);t=current_queue_index;if(t<0||t>=getCurrentQueueLength()){t=getCurrentQueueLength()-1}}else{log("Current playing item is in the list, currentIndex is "+e);if(t>=getCurrentQueueLength()){t=-2}}log("Next index is : "+t);return t}function getIndexOfPreviousItem(){if(getCurrentQueueLength==0){log("Can't go previous in an empty queue");return-1}var e=getIndexOf(globalCurrentMedia);var t=e-1;if(e==-1){log("Current playing item is not in list");t=current_queue_index-1;if(t<0||t>=getCurrentQueueLength()){t=0}}else{log("Current playing item is in the list");if(t<0){t=0}}log("Previous index is : "+t);return t}function onYouTubeIframeAPIReady(){log("iFrame player is ready");youtubePlayer=new YT.Player("youtube-player",{height:"100%",width:"100%",playerVars:{autoplay:1,controls:0,iv_load_policy:3,rel:0,showinfo:0},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange,onError:onPlayerError,onPlaybackQualityChange:onQualityChange}})}function onPlayerReady(e){log("Player Ready called");setCurrentMediaplayer(YOUTUBE_PLAYER);youtubePlayerReady=true;if(globalCurrentMedia!=null){youtubePlayer.loadVideoById(globalCurrentMedia.video_id,0,youtubeDefaultQuality)}}function onPlayerStateChange(e){log("Youtube player state : "+e.data);switch(e.data){case-1:log("State: Unstarted");setAndBroadcastPlayerState(STATE_STOPPED);if(destroyPlayer){teeweYoutubePlayer.destroyPlayer()}break;case YT.PlayerState.ENDED:log("State: Playback Ended");setAndBroadcastPlayerState(STATE_STOPPED);playbackEnded();break;case YT.PlayerState.PLAYING:log("State: Playing");setAndBroadcastPlayerState(STATE_PLAYING);hideLoadingUI(false);break;case YT.PlayerState.PAUSED:log("State: Paused");setAndBroadcastPlayerState(STATE_PAUSED);break;case YT.PlayerState.BUFFERING:log("State: Buffering");setAndBroadcastPlayerState(STATE_LOADING);break}}function onPlayerError(e){logError("onPlayerError called : "+e.data);hideLoadingUI(false);if(e.data==150){showYoutubeError()}errorTimeout=setTimeout(function(){playbackEnded()},8e3)}function onQualityChange(e){log("Player quality changed :"+e.data);broadcastCurrentYoutubeQuality(e.data)}function showSplash(){$("#basic-container").after('<div id="splash"></div>');log("setting timer");setTimeout(function(){log("timer called");showHomescreen()},3e3)}function showHomescreen(){$('<div id="home-screen"><div id="homescreen-image-div"></div><div id="homescreen-text-div"><p id="homescreen-title"></p><p id="homescreen-text"></p></div></div>').replaceAll("#splash");$("#homescreen-title").text("Ready to watch?");$("#homescreen-text").text("Use the Teewe app on your phone, tablet or computer to watch media on this television")}function showLoadingUI(e){hidePauseScreen(false);if(e.type==AUDIO_TYPE){showAudioUI(e);return}hideAudioUI();hideSeekUI(false);hidePauseScreen(false);hideYoutubeError();hideVideoAudioError();if(document.getElementById("video-div")!=null){updateLoadingUI(e);return}var t=document.createElement("div");t.id="video-div";t.className="videoPlayer";var n=document.createElement("div");n.id="video-background-gradient";t.appendChild(n);var r=document.createElement("div");r.id="video-actual-gradient";t.appendChild(r);var i=document.createElement("div");i.id="video-footer";i.className="videoPlayer";t.appendChild(i);var s=document.createElement("div");s.id="video-thumbnail";s.className="videoPlayer";i.appendChild(s);var o=document.createElement("div");o.id="video-text-div";o.className="videoPlayer";i.appendChild(o);var u=document.createElement("p");u.id="video-title";u.className="videoPlayer";o.appendChild(u);var a=document.createElement("div");a.id="video-subtitle-div";a.className="videoPlayer";o.appendChild(a);var f=document.createElement("div");f.id="video-subtitle-icon";f.className="videoPlayer";a.appendChild(f);var l=document.createElement("p");l.id="video-subtitle";l.className="videoPlayer";a.appendChild(l);var c=document.createElement("div");c.id="video-loading-div";c.className="videoPlayer";o.appendChild(c);var h=document.createElement("div");h.id="video-loader";h.className="videoPlayer";c.appendChild(h);var p=document.createElement("p");p.id="video-loading-text";p.className="videoPlayer";p.innerHTML="Loading...";c.appendChild(p);var d=document.getElementById("container");d.appendChild(t);updateLoadingUI(e)}function hideLoadingUIbg(){var e=document.getElementById("video-background-gradient");var t=document.getElementById("video-actual-gradient");if(e!=null){e.style.display="none"}if(t!=null){t.style.display="none"}}function updateLoadingUI(e){if(e.type==YOUTUBE_TYPE){hideLoadingUIbg()}if(document.getElementById("video-div")!=null){if(e.type!=YOUTUBE_TYPE)document.getElementById("video-background-gradient").style.backgroundImage="url("+e.thumbnail_url+"), url(ccjs/images/default_video_thumb.png)";document.getElementById("video-thumbnail").style.backgroundImage="url("+e.thumbnail_url+"), url(ccjs/images/default_video_thumb.png)";document.getElementById("video-title").innerHTML=e.title;document.getElementById("video-subtitle").innerHTML=e.source;document.getElementById("video-loader").style.backgroundImage="url(ccjs/images/loader_png.png)";var t=function(){$("#video-loader").rotate({angle:0,animateTo:360,callback:t})};t();switch(e.type){case YOUTUBE_TYPE:document.getElementById("video-subtitle-icon").style.backgroundImage="url(ccjs/images/yt_icon.png)";break;case VIDEO_TYPE:document.getElementById("video-subtitle-icon").style.backgroundImage="url(ccjs/images/device_icon.png)";break}}}function showAudioUI(e){hideYoutubeError();hideVideoAudioError();if(document.getElementById("audio-div")==null){var t=$('<div id="audio-div"><div id="audio-background"></div><div id="audio-background-gradient"></div><div id="audio-metadata-div"><div id="audio-thumbnail-div"><div id="audio-thumbnail-state"></div></div><div id="audio-meta-text"><p id="audio-title-text"></p><p id="audio-album-text"></p><p id="audio-artist-text"></p><div id="audio-subtitle-div"><div id="audio-subtitle-icon"></div><p id="audio-subtitle-text"></p><div id="audio-teewe-logo"></div></div></div></div></div>');$("#container").append(t);$("#audio-div").append(getProgressbarDiv());$("#progress-div").css("padding-left","40px");updateAudioUI(e)}else{updateAudioUI(e)}}function updateAudioUI(e){if(document.getElementById("audio-div")==null){return}if(e!=null&&e!=undefined){document.getElementById("audio-background").style.backgroundImage="url("+e.thumbnail_url+"), url(ccjs/images/default_audio_thumb.png)";document.getElementById("audio-teewe-logo").style.backgroundImage="url(ccjs/images/teewe_logo_pause.png)";document.getElementById("audio-subtitle-icon").style.backgroundImage="url(ccjs/images/device_icon.png)";document.getElementById("audio-thumbnail-div").style.backgroundImage="url("+e.thumbnail_url+"), url(ccjs/images/default_audio_thumb.png)";document.getElementById("audio-title-text").innerHTML=e.title;document.getElementById("audio-album-text").innerHTML=e.album_name==undefined?"Unknown Album":e.album_name;document.getElementById("audio-artist-text").innerHTML=e.artist_name==undefined?"Unknown Artist":e.artist_name;document.getElementById("audio-subtitle-text").innerHTML=e.source;updateAudioState(STATE_LOADING);updateProgressDiv(0,0)}}function updateAudioState(e){if(document.getElementById("audio-div")==null){return}var t="ccjs/images/pause_state_icon.png";var n="ccjs/images/loader_png.png";var r=document.getElementById("audio-thumbnail-state");switch(e){case STATE_PLAYING:r.style.display="none";break;case STATE_PAUSED:r.style.display="block";if(r.style.backgroundImage.indexOf(t)==-1){r.style.backgroundImage="url("+t+")"}break;case STATE_LOADING:r.style.display="block";if(r.style.backgroundImage.indexOf(n)==-1){r.style.backgroundImage="url("+n+")"}break}}function hideAudioUI(){if(document.getElementById("audio-div")!=null){$("#audio-div").remove()}}function hideLoadingUI(e){if(document.getElementById("video-div")!=null){if(e){$("#video-div").fadeOut(1e3,function(){$("#video-div").remove()})}else{$("#video-div").remove()}}}function showSeekUI(e,t,n){if(globalCurrentMedia!=null&&globalCurrentMedia.type==AUDIO_TYPE){return}var r=getProgressbarDiv();$("#container").append(r);$("#progress-div").css("z-index","3");$("#progress-div").css("padding-left","40px");updateProgressDiv(t,n);setTimeout(function(){hideSeekUI(true)},2e3)}function hideSeekUI(e){if(e){$("#progress-div").fadeOut(1e3,function(){$("#progress-div").remove()})}else{$("#progress-div").remove()}}function getProgressbarDiv(){var e=document.getElementById("progress-div");if(e==null){e=$('<div id="progress-div" </div>').append('<p id="current-time-text">00:00:00</p>').append('<progress id="progress-bar" max="100" value="0">></progress>').append('<p id="total-duration-text">00:00:00</p>');return e}else{return e}}function updateProgressDiv(e,t){var n=e;var r=t;var i=0;if(r!=0)i=100*n/r;var s=document.getElementById("progress-div");if(s!=null){$("#current-time-text").html(convertTime(n));$("#total-duration-text").html(convertTime(r));$("#progress-bar").val(i)}}function showPauseScreen(e,t,n){if(e.type==AUDIO_TYPE){return}var r=document.getElementById("pause-div");if(r==null){log("current position : "+t);log("duration  : "+n);var i=$('<div id="metadata-div"><div id = "meta-thumbnail-div"><div id = "meta-state-icon"></div></div><div id = "meta-title-div"><p id = "meta-title-text"></p><div id = "meta-subtitle-div"><div id = "meta-subtitle-icon"></div><p id = "meta-subtitle-text"></p><div id = "meta-teewe-logo"></div></div></div></div>');r=$('<div id = "pause-div"></div>').append(i).append(getProgressbarDiv());$("#container").append(r);updatePauseScreen(e,t,n);updateProgressDiv(t,n)}else{updatePauseScreen(e,t,n)}}function updatePauseScreen(e,t,n){document.getElementById("meta-state-icon").style.backgroundImage="url(ccjs/images/pause_state_icon.png)";document.getElementById("meta-teewe-logo").style.backgroundImage="url(ccjs/images/teewe_logo_pause.png)";document.getElementById("meta-thumbnail-div").style.backgroundImage="url("+e.thumbnail_url+"), url(ccjs/images/default_video_thumb.png)";document.getElementById("meta-title-text").innerHTML=e.title;document.getElementById("meta-subtitle-text").innerHTML=e.source;switch(e.type){case YOUTUBE_TYPE:document.getElementById("meta-subtitle-icon").style.backgroundImage="url(ccjs/images/yt_icon.png)";break;case VIDEO_TYPE:document.getElementById("meta-subtitle-icon").style.backgroundImage="url(ccjs/images/device_icon.png)";break}}function hidePauseScreen(e){if(globalCurrentMedia.type==AUDIO_TYPE){return}if(document.getElementById("pause-div")!=null){if(e){$("#pause-div").fadeOut(1e3,function(){$("#pause-div").remove()})}else{$("#pause-div").remove()}}}function stopAndGotoHome(){hidePauseScreen(false);hideAudioUI();hideSeekUI(false);hideLoadingUI(false);hideYoutubeError();hideVideoAudioError()}function convertTime(e){var t=Math.floor(e/3600);var n=Math.floor((e-t*3600)/60);var r=e-t*3600-n*60;if(t<10){t="0"+t}if(n<10){n="0"+n}if(r<10){r="0"+r}var i=t+":"+n+":"+r;return i}function showYoutubeError(){if(document.getElementById("youtube-error-div")==null){var e="Oops!";var t="The uploader has restricted playback on platforms other than YouTube.com";var n=$('<div id="youtube-error-div"><p id="yt-error-title-text"></p><p id="yt-error-description-text"></p></div>');$("#container").append(n);$("#yt-error-title-text").text(e);$("#yt-error-description-text").text(t)}}function hideYoutubeError(){if(document.getElementById("youtube-error-div")!=null){$("#youtube-error-div").remove()}}function showVideoAudioError(){if(document.getElementById("media-error-div")==null){var e="Oops!";var t="This media cannot be played on this device.";var n="This may be because: <br><br>1. The video codec is not supported <br>2. You are having trouble with your WiFi network";var r=$('<div id="media-error-div"><p id="media-error-title-text"></p><p id="media-error-description-text"></p><p id="media-error-footer-text"></p></div>');$("#container").append(r);$("#media-error-title-text").text(e);$("#media-error-description-text").text(t);$("#media-error-footer-text").html(n)}}function hideVideoAudioError(){if(document.getElementById("media-error-div")!=null){$("#media-error-div").remove()}}const STATE_PLAYING="PLAYING";const STATE_PAUSED="PAUSED_PLAYBACK";const STATE_STOPPED="STOPPED";const STATE_NO_MEDIA="NO_MEDIA_PRESENT";const STATE_LOADING="LOADING";const YOUTUBE_TYPE=1;const VIDEO_TYPE=2;const AUDIO_TYPE=6;const IMAGE_TYPE=5;const TEEWE_CC_API_VERSION="1.0";const STATUS_CODE_OK=200;const STATUS_CODE_NOT_FOUND=404;const STATUS_CODE_SERVER_ERROR=500;const RESPONSE_TYPE_BROADCAST="BROADCAST";const RESPONSE_TYPE_RESPONSE="RESPONSE";const BROADCAST_CURRENT_POSITION="CURRENT_POSITION";const BROADCAST_NOW_PLAYING="NOW_PLAYING_MEDIA_CHANGED";const BROADCAST_QUEUE_UPDATED="QUEUE_UPDATED";const BROADCAST_CURRENT_STATE="CURRENT_STATE";const BROADCAST_YOUTUBE_QUALITY="CURRENT_YOUTUBE_QUALITY";const YOUTUBE_PLAYER="youtube-player";const VIDEO_PLAYER="video-player";const AUDIO_PLAYER="audio-player";const IMAGE_PLAYER="image-player";const NONE="none";var teeweImageViewer;var ImageViewerSingleton=function(){function r(){var e=new i;return e}function i(){this.loadPlayer=s;this.loadImage=o;this.stop=u}function s(e){if(document.getElementById("image-viewer-div")==null&&!n){$("#container").append('<div id="image-viewer-div"><img id="image-viewer"></img></div>');t=document.getElementById("image-viewer")}setCurrentMediaplayer(IMAGE_PLAYER);n=true;o(e)}function o(e){if(n){a();if(t.src==e.url){f()}t.src=e.url;t.onload=f;t.onerror=c}else{s(e)}}function u(){if(t!=null){l();t.removeAttribute("src");$("#image-viewer-div").remove();t=null;n=false}}function a(){setAndBroadcastPlayerState(STATE_LOADING);t.style.display="none"}function f(){setAndBroadcastPlayerState(STATE_PLAYING);t.style.display="table"}function l(){setAndBroadcastPlayerState(STATE_STOPPED)}function c(){log("Error loading image : "+globalCurrentMedia.url)}var e;var t;var n=false;return{getInstance:function(){if(!e){e=r()}return e}}}();teeweImageViewer=ImageViewerSingleton.getInstance();var durationTimer=false;var globalPlayerState=STATE_NO_MEDIA;var globalCurrentMedia=null;var current_queue_index=0;var CURRENT_MEDIA_PLAYER=NONE;var errorTimeout=false;var queueMap={};var queueOrder=[];var teeweVideoPlayer;var VideoSingleton=function(){function i(){var e=new s;return e}function s(){this.loadPlayer=o;this.loadVideo=u;this.pause=f;this.play=l;this.stop=c;this.seek=h;this.getCurrentPosition=p;this.duration=d}function o(){var e=document.getElementById("container");if(document.getElementById("video-player")==null){t=document.createElement("video");t.id="video-player";t.className="videoPlayer";t.autoPlay=true;t.preload="auto";e.appendChild(t);showLoadingUI(globalCurrentMedia);a()}else{log("Video player already loaded");a()}}function u(e){if(n){showLoadingUI(e);r=false;t.src=e.url;t.onplaying=m;t.onseeking=E;t.onwaiting=v;t.onended=g;t.onpause=b;t.onerror=w;t.play();log(t.canPlayType("video/x-msvideo"))}else{o()}}function a(){n=true;setCurrentMediaplayer(VIDEO_PLAYER);log("Video player is ready to play");if(globalCurrentMedia!=null){teeweVideoPlayer.loadVideo(globalCurrentMedia)}}function f(){if(t!=null)t.pause();showPauseScreen(globalCurrentMedia,getCurrentPositionInSeconds(),getTotalDurationInSeconds())}function l(){if(t!=null)t.play();hidePauseScreen(true)}function c(){if(t!=null){r=true;t.removeAttribute("src");delete t;document.getElementById("container").removeChild(document.getElementById("video-player"));n=false;t=null;stopAndGotoHome();y()}}function h(e){showSeekUI(globalCurrentMedia,e,getTotalDurationInSeconds());if(t!=null)t.currentTime=e}function p(){if(t==null)return 0;var e=t.currentTime;if(isNaN(e))return 0;else return e}function d(){if(t==null)return 0;var e=t.duration;if(isNaN(e))return 0;else return e}function v(){setAndBroadcastPlayerState(STATE_LOADING)}function m(){setAndBroadcastPlayerState(STATE_PLAYING);hideLoadingUI(false)}function g(){setAndBroadcastPlayerState(STATE_STOPPED);playbackEnded()}function y(){setAndBroadcastPlayerState(STATE_STOPPED)}function b(){if(!r){setAndBroadcastPlayerState(STATE_PAUSED)}}function w(e){var t=e.target.error.code;logError("Error code : "+t);hideLoadingUI(false);showVideoAudioError();errorTimeout=setTimeout(function(){g()},8e3)}function E(){setAndBroadcastPlayerState(STATE_LOADING)}var e;var t;var n=false;var r=false;return{getInstance:function(){if(!e){e=i()}return e}}}();teeweVideoPlayer=VideoSingleton.getInstance();var teeweYoutubePlayer;var youtubePlayerReady=false;var youtubePlayer;var destroyPlayer=false;var youtubeDefaultQuality="default";var YoutubeSingleton=function(){function t(){var e=new n;return e}function n(){this.loadPlayer=r;this.loadVideo=l;this.play=s;this.pause=i;this.stop=c;this.seek=o;this.getCurrentPosition=u;this.duration=a;this.destroyPlayer=f}function r(){setAndBroadcastPlayerState(STATE_LOADING);destroyPlayer=false;var e=document.createElement("div");e.id="youtube-player";e.className="ytplayer";document.getElementById("container").appendChild(e);if(document.getElementById("youtube-script-id")==null){var t=document.createElement("script");t.id="youtube-script-id";t.src="https://www.youtube.com/iframe_api";var n=document.getElementById("youtube-player");n.parentNode.insertBefore(t,n)}else{var t=document.getElementById("youtube-script-id");var n=document.getElementById("youtube-player");n.parentNode.insertBefore(t,n);onYouTubeIframeAPIReady()}log("iframe created")}function i(){showPauseScreen(globalCurrentMedia,getCurrentPositionInSeconds(),getTotalDurationInSeconds());if(youtubePlayer!=null)youtubePlayer.pauseVideo()}function s(){hidePauseScreen(true);if(youtubePlayer!=null)youtubePlayer.playVideo()}function o(e){showSeekUI(globalCurrentMedia,e,getTotalDurationInSeconds());if(youtubePlayer!=null)youtubePlayer.seekTo(e,true)}function u(){if(youtubePlayer==null)return 0;var e=youtubePlayer.getCurrentTime();if(isNaN(e))return 0;else return e}function a(){if(youtubePlayer==null)return 0;var e=youtubePlayer.getDuration();if(isNaN(e))return 0;else return e}function f(){youtubePlayer.destroy();document.getElementById("container").removeChild(document.getElementById("youtube-player"));destroyPlayer=false;youtubePlayerReady=false}function l(e){if(youtubePlayerReady){log("youtube player is loaded. starting to play videoid : "+e.video_id);youtubePlayer.loadVideoById(e.video_id,0,youtubeDefaultQuality)}else{log("Youtube Player is not ready");r()}showLoadingUI(e)}function c(){stopAndGotoHome();log("Stopping video and killing youtube player");if(youtubePlayer.getPlayerState()==-1){f()}else{destroyPlayer=true;youtubePlayer.stopVideo()}}function h(e){var t=["small","medium","large","hd720","highres","hd1080","default"];if(t.indexOf(e)!=-1){youtubeDefaultQuality=e}else{youtubeDefaultQuality="default"}youtubePlayer.setPlaybackQuality(youtubeDefaultQuality)}function p(){return youtubePlayer.getPlaybackQuality()}var e;return{getInstance:function(){if(!e){e=t()}return e}}}();teeweYoutubePlayer=YoutubeSingleton.getInstance()
