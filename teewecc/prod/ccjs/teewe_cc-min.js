function broadcastPlayerState(b){if(b!=null){var a=new currentStatePayload(b);var c=new broadcast(STATUS_CODE_OK,a);var d=JSON.stringify(c);log(d);broadcastMessage(d)}}function broadcastCurrentPosition(a){var b=new broadcast(STATUS_CODE_OK,a);broadcastMessage(JSON.stringify(b))}function broadcastCurrentMetadata(a){if(a!=null){var b=new currentMetadataPayload(a);var c=JSON.stringify(new broadcast(STATUS_CODE_OK,b));log(c);broadcastMessage(c);broadcastCurrentPosition(new currentPositionPayload(0,0))}}function broadcastCurrentQueue(b){if(b!=null){var a=new currentQueuePayload(b);var c=JSON.stringify(new broadcast(STATUS_CODE_OK,a));broadcastMessage(c)}}function broadcastCurrentYoutubeQuality(c){if(c!=null){var a=new currentYoutubeQualityPayload(c);var b=JSON.stringify(new broadcast(STATUS_CODE_OK,a));broadcastMessage(b)}}const STATE_PLAYING="PLAYING";const STATE_PAUSED="PAUSED_PLAYBACK";const STATE_STOPPED="STOPPED";const STATE_NO_MEDIA="NO_MEDIA_PRESENT";const STATE_LOADING="LOADING";const YOUTUBE_TYPE=1;const VIDEO_TYPE=2;const AUDIO_TYPE=6;const IMAGE_TYPE=5;const TEEWE_CC_API_VERSION="1.0";const STATUS_CODE_OK=200;const STATUS_CODE_NOT_FOUND=404;const STATUS_CODE_SERVER_ERROR=500;const RESPONSE_TYPE_BROADCAST="BROADCAST";const RESPONSE_TYPE_RESPONSE="RESPONSE";const BROADCAST_CURRENT_POSITION="CURRENT_POSITION";const BROADCAST_NOW_PLAYING="NOW_PLAYING_MEDIA_CHANGED";const BROADCAST_QUEUE_UPDATED="QUEUE_UPDATED";const BROADCAST_CURRENT_STATE="CURRENT_STATE";const BROADCAST_YOUTUBE_QUALITY="CURRENT_YOUTUBE_QUALITY";const YOUTUBE_PLAYER="youtube-player";const VIDEO_PLAYER="video-player";const AUDIO_PLAYER="audio-player";const IMAGE_PLAYER="image-player";const NONE="none";var teeweImageViewer;var ImageViewerSingleton=(function(){var k;var d;var a=false;function g(){var m=new j();return m}function j(){this.loadPlayer=h;this.loadImage=c;this.stop=e}function h(m){if(document.getElementById("image-viewer-div")==null&&!a){$("#container").append('<div id="image-viewer-div"><img id="image-viewer"></img></div>');d=document.getElementById("image-viewer")}setCurrentMediaplayer(IMAGE_PLAYER);a=true;c(m)}function c(m){if(a){l();if(d.src==m.url){i()}d.src=m.url;d.onload=i;d.onerror=f}else{h(m)}}function e(){if(d!=null){b();d.removeAttribute("src");$("#image-viewer-div").remove();d=null;a=false}}function l(){setAndBroadcastPlayerState(STATE_LOADING);d.style.display="none"}function i(){setAndBroadcastPlayerState(STATE_PLAYING);d.style.display="table"}function b(){setAndBroadcastPlayerState(STATE_STOPPED)}function f(){log("Error loading image : "+globalCurrentMedia.url)}return{getInstance:function(){if(!k){k=g()}return k}}})();teeweImageViewer=ImageViewerSingleton.getInstance();function broadcast(a,b){this.type=RESPONSE_TYPE_BROADCAST;this.version=TEEWE_CC_API_VERSION;this.status_code=a;this.payload=b}function response(){}function currentPositionPayload(a,b){this.broadcast_type=BROADCAST_CURRENT_POSITION;this.payload={current_position:{position:a,total_duration:b}}}function currentMetadataPayload(a){this.broadcast_type=BROADCAST_NOW_PLAYING;this.payload={mediaitem:a}}function currentStatePayload(a){this.broadcast_type=BROADCAST_CURRENT_STATE;this.payload={state:a}}function currentQueuePayload(a){this.broadcast_type=BROADCAST_QUEUE_UPDATED;this.payload={current_queue:a}}function currentYoutubeQualityPayload(a){this.broadcast_type=BROADCAST_YOUTUBE_QUALITY;this.payload={youtube_quality:a}}var durationTimer=false;var globalPlayerState=STATE_NO_MEDIA;var globalCurrentMedia=null;var current_queue_index=0;var CURRENT_MEDIA_PLAYER=NONE;var errorTimeout=false;function startDurationTimer(){if(durationTimer!=false){stopDurationTimer()}durationTimer=setInterval(function(){var a=getCurrentPositionInSeconds();var b=getTotalDurationInSeconds();broadcastCurrentPosition(new currentPositionPayload(a,b));if(globalCurrentMedia!=null&&globalCurrentMedia.type==AUDIO_TYPE){updateProgressDiv(a,b)}},1000)}function stopDurationTimer(){if(durationTimer!=false){window.clearInterval(durationTimer);duration=false}}function setCurrentMediaplayer(a){log("Setting current media player to : "+a);var b=[YOUTUBE_PLAYER,VIDEO_PLAYER,AUDIO_PLAYER,IMAGE_PLAYER,NONE];if(b.indexOf(a)!=-1){CURRENT_MEDIA_PLAYER=a}else{CURRENT_MEDIA_PLAYER=NONE}}function setAndBroadcastPlayerState(b){log(b);var a=[STATE_NO_MEDIA,STATE_PLAYING,STATE_PAUSED,STATE_STOPPED,STATE_LOADING];if(a.indexOf(b)!=-1){globalPlayerState=b;if(globalPlayerState==STATE_PLAYING&&globalCurrentMedia.type!=IMAGE_TYPE){startDurationTimer()}else{stopDurationTimer()}}else{log("Invalid state : "+b);globalPlayerState=STATE_STOPPED}if(globalCurrentMedia!=null&&globalCurrentMedia.type==AUDIO_TYPE){updateAudioState(globalPlayerState)}broadcastPlayerState(globalPlayerState);if(globalPlayerState==STATE_STOPPED){broadcastCurrentPosition(new currentPositionPayload(0,0))}}function getCurrentPositionInSeconds(){var a;if(globalCurrentMedia!=null){switch(globalCurrentMedia.type){case YOUTUBE_TYPE:a=teeweYoutubePlayer.getCurrentPosition();break;case VIDEO_TYPE:a=teeweVideoPlayer.getCurrentPosition();break;case AUDIO_TYPE:a=teeweVideoPlayer.getCurrentPosition();break;case IMAGE_TYPE:break;default:break}if(a==null){a=0}return Math.round(a)}}function getTotalDurationInSeconds(){var a;if(globalCurrentMedia!=null){switch(globalCurrentMedia.type){case YOUTUBE_TYPE:a=teeweYoutubePlayer.duration();break;case VIDEO_TYPE:a=teeweVideoPlayer.duration();break;case AUDIO_TYPE:a=teeweVideoPlayer.duration();break;case IMAGE_TYPE:break;default:break}if(a==null){a=0}return Math.round(a)}}function setNowPlaying(a){globalCurrentMedia=a;current_queue_index=getIndexOf(globalCurrentMedia);broadcastCurrentMetadata(globalCurrentMedia);log("Setting now playing index to "+current_queue_index);log("Setting now playing item to "+globalCurrentMedia.title)}function loadItem(d,b){var c=d.type;log("media type is : "+c);log("Loading item of type : "+d.type_string);if(b){log("Adding to queue : "+d.title);var a=getCurrentPlayingIndex();if(a==-1){addToQueueLast(d)}else{addToQueueAtPosition(a+1,d)}}else{log("Not adding to queue : "+d.title)}setNowPlaying(d);clearErrorTimeout();log("Current mediaplayer is : "+CURRENT_MEDIA_PLAYER);switch(c){case YOUTUBE_TYPE:if(CURRENT_MEDIA_PLAYER!=YOUTUBE_PLAYER){stopAllMedia()}teeweYoutubePlayer.loadVideo(d);break;case VIDEO_TYPE:if(CURRENT_MEDIA_PLAYER!=VIDEO_PLAYER){stopAllMedia()}teeweVideoPlayer.loadVideo(d);break;case AUDIO_TYPE:if(CURRENT_MEDIA_PLAYER!=VIDEO_PLAYER){stopAllMedia()}teeweVideoPlayer.loadVideo(d);break;case IMAGE_TYPE:if(CURRENT_MEDIA_PLAYER!=IMAGE_PLAYER){stopAllMedia()}teeweImageViewer.loadImage(d);break;default:log("No case matched")}}function stopMedia(){stopAllMedia()}function stopAllMedia(){if(document.getElementById("video-player")!=null){teeweVideoPlayer.stop()}if(document.getElementById("youtube-player")!=null){teeweYoutubePlayer.stop()}if(document.getElementById("image-viewer-div")!=null){teeweImageViewer.stop()}setCurrentMediaplayer(NONE)}function pauseMedia(){if(globalCurrentMedia!=null){switch(globalCurrentMedia.type){case YOUTUBE_TYPE:teeweYoutubePlayer.pause();break;case VIDEO_TYPE:teeweVideoPlayer.pause();break;case AUDIO_TYPE:teeweVideoPlayer.pause();break;case IMAGE_TYPE:break;default:break}}}function seekMedia(a){if(globalCurrentMedia!=null){switch(globalCurrentMedia.type){case YOUTUBE_TYPE:teeweYoutubePlayer.seek(a);break;case VIDEO_TYPE:teeweVideoPlayer.seek(a);break;case AUDIO_TYPE:teeweVideoPlayer.seek(a);break;case IMAGE_TYPE:break;default:break}}}function playMedia(){if(globalCurrentMedia!=null){if(globalPlayerState==STATE_STOPPED){loadItem(globalCurrentMedia,false);return}switch(globalCurrentMedia.type){case YOUTUBE_TYPE:teeweYoutubePlayer.play();break;case VIDEO_TYPE:teeweVideoPlayer.play();break;case AUDIO_TYPE:teeweVideoPlayer.play();break;case IMAGE_TYPE:break;default:break}}}function goNext(){var b=getIndexOfNextItem();if(b<0){log("There is no next item to be played")}else{var a=getItemAtPosition(b);if(a!=null){log("Next item to be played is : "+a.title);loadItem(a,false)}else{log("Couldn't fetch item at : "+b)}}}function goPrevious(){var b=getIndexOfPreviousItem();if(b==-1){log("There is no item to be played")}else{var a=getItemAtPosition(b);if(a!=null){log("Previous item to be played is : "+a.title);loadItem(a,false)}else{log("Couldn't fetch item at : "+b)}}}function playbackEnded(){if(getIndexOfNextItem()==-2){queuePlaybackEnded()}else{goNext()}}function queuePlaybackEnded(){log("Queue Playback Finished");stopMedia()}function loadItemMultiple(b,a){}function clearErrorTimeout(){if(errorTimeout!=false){clearTimeout(errorTimeout);errorTimeout=false}}var queueMap={};var queueOrder=[];function addToQueueAtPosition(a,b){if(a<0||b==null){return}if(!(b.unique_id in queueMap)){queueMap[b.unique_id]=b;queueOrder.splice(a,0,b.unique_id);log(queueOrder.join("</br>"));log(JSON.stringify(queueMap));broadcastCurrentQueue(getQueue())}else{log("Item already in queue : "+b.title)}}function addToQueueLast(a){addToQueueAtPosition(queueOrder.length,a)}function addToQueueMultipleAtPosition(b,d){if(b<0||d==null){return}var a=[];for(var c=0;c<d.length;c++){if(!(d[c].unique_id in queueMap)){queueMap[d[c].unique_id]=d[c];a.push(d[c].unique_id)}}if(a.length!=0){for(var c=0;c<a.length;c++){queueOrder.splice(b+c,0,a[c])}broadcastCurrentQueue(getQueue())}}function addToQueueMultipleLast(a){addToQueueMultipleAtPosition(queueOrder.length,a)}function removeItemFromQueue(a){if(a==null||queueOrder.length==0){return}if(a.unique_id in queueMap){delete queueMap[a.unique_id];queueOrder.splice(queueOrder.indexOf(a.unique_id),1);log("Item deleted from queue : "+a.unique_id);broadcastCurrentQueue(getQueue())}else{log("Can't find this item in queue : "+a.unique_id)}}function removeIndexFromQueue(a){if(queueOrder.length!=0&&a>=0&&a<queueOrder.length){removeItemFromQueue(queueMap[queueOrder[a]])}}function clearQueue(){if(queueOrder.length!=0){queueOrder=[];queueMap={};broadcastCurrentQueue(getQueue())}}function getIndexOf(a){if(a==null||a.unique_id==null){return -1}return queueOrder.indexOf(a.unique_id)}function getCurrentPlayingIndex(){return getIndexOf(globalCurrentMedia)}function getItemAtPosition(a){if(queueOrder.length!=0&&a>=0&&a<queueOrder.length){return queueMap[queueOrder[a]]}}function getQueue(){var a=[];for(var b=0;b<queueOrder.length;b++){a.push(getItemAtPosition(b))}return a}function getCurrentQueueLength(){return queueOrder.length}function getIndexOfNextItem(){if(getCurrentQueueLength()==0){log("Can't go next in an empty queue");return -1}var b=getIndexOf(globalCurrentMedia);var a=b+1;if(b==-1){log("Current playing item is not in list, current_queue_index is :"+current_queue_index);a=current_queue_index;if(a<0||a>=getCurrentQueueLength()){a=getCurrentQueueLength()-1}}else{log("Current playing item is in the list, currentIndex is "+b);if(a>=getCurrentQueueLength()){a=-2}}log("Next index is : "+a);return a}function getIndexOfPreviousItem(){if(getCurrentQueueLength==0){log("Can't go previous in an empty queue");return -1}var a=getIndexOf(globalCurrentMedia);var b=a-1;if(a==-1){log("Current playing item is not in list");b=current_queue_index-1;if(b<0||b>=getCurrentQueueLength()){b=0}}else{log("Current playing item is in the list");if(b<0){b=0}}log("Previous index is : "+b);return b}function showSplash(){$("#basic-container").after('<div id="splash"></div>');log("setting timer");setTimeout(function(){log("timer called");showHomescreen()},3000)}function showHomescreen(){$('<div id="home-screen"><div id="homescreen-image-div"></div><div id="homescreen-text-div"><p id="homescreen-title"></p><p id="homescreen-text"></p></div></div>').replaceAll("#splash");$("#homescreen-title").text("Ready to watch?");$("#homescreen-text").text("Use the Teewe app on your phone, tablet or computer to watch media on this television")}function showLoadingUI(m){hidePauseScreen(false);if(m.type==AUDIO_TYPE){showAudioUI(m);return}hideAudioUI();hideSeekUI(false);hidePauseScreen(false);hideYoutubeError();hideVideoAudioError();if(document.getElementById("video-div")!=null){updateLoadingUI(m);return}var l=document.createElement("div");l.id="video-div";l.className="videoPlayer";var f=document.createElement("div");f.id="video-background-gradient";l.appendChild(f);var k=document.createElement("div");k.id="video-actual-gradient";l.appendChild(k);var g=document.createElement("div");g.id="video-footer";g.className="videoPlayer";l.appendChild(g);var a=document.createElement("div");a.id="video-thumbnail";a.className="videoPlayer";g.appendChild(a);var n=document.createElement("div");n.id="video-text-div";n.className="videoPlayer";g.appendChild(n);var i=document.createElement("p");i.id="video-title";i.className="videoPlayer";n.appendChild(i);var e=document.createElement("div");e.id="video-subtitle-div";e.className="videoPlayer";n.appendChild(e);var d=document.createElement("div");d.id="video-subtitle-icon";d.className="videoPlayer";e.appendChild(d);var h=document.createElement("p");h.id="video-subtitle";h.className="videoPlayer";e.appendChild(h);var b=document.createElement("div");b.id="video-loading-div";b.className="videoPlayer";n.appendChild(b);var j=document.createElement("div");j.id="video-loader";j.className="videoPlayer";b.appendChild(j);var c=document.createElement("p");c.id="video-loading-text";c.className="videoPlayer";c.innerHTML="Loading...";b.appendChild(c);var o=document.getElementById("container");o.appendChild(l);updateLoadingUI(m)}function hideLoadingUIbg(){var a=document.getElementById("video-background-gradient");var b=document.getElementById("video-actual-gradient");if(a!=null){a.style.display="none"}if(b!=null){b.style.display="none"}}function updateLoadingUI(b){if(b.type==YOUTUBE_TYPE){hideLoadingUIbg()}if(document.getElementById("video-div")!=null){if(b.type!=YOUTUBE_TYPE){document.getElementById("video-background-gradient").style.backgroundImage="url("+b.thumbnail_url+"), url(ccjs/images/default_video_thumb.png)"}document.getElementById("video-thumbnail").style.backgroundImage="url("+b.thumbnail_url+"), url(ccjs/images/default_video_thumb.png)";document.getElementById("video-title").innerHTML=b.title;document.getElementById("video-subtitle").innerHTML=b.source;document.getElementById("video-loader").style.backgroundImage="url(ccjs/images/loader_png.png)";var a=function(){$("#video-loader").rotate({angle:0,animateTo:360,callback:a})};a();switch(b.type){case YOUTUBE_TYPE:document.getElementById("video-subtitle-icon").style.backgroundImage="url(ccjs/images/yt_icon.png)";break;case VIDEO_TYPE:document.getElementById("video-subtitle-icon").style.backgroundImage="url(ccjs/images/device_icon.png)";break}}}function showAudioUI(b){hideYoutubeError();hideVideoAudioError();if(document.getElementById("audio-div")==null){var a=$('<div id="audio-div"><div id="audio-background"></div><div id="audio-background-gradient"></div><div id="audio-metadata-div"><div id="audio-thumbnail-div"><div id="audio-thumbnail-state"></div></div><div id="audio-meta-text"><p id="audio-title-text"></p><p id="audio-album-text"></p><p id="audio-artist-text"></p><div id="audio-subtitle-div"><div id="audio-subtitle-icon"></div><p id="audio-subtitle-text"></p><div id="audio-teewe-logo"></div></div></div></div></div>');$("#container").append(a);$("#audio-div").append(getProgressbarDiv());$("#progress-div").css("padding-left","40px");updateAudioUI(b)}else{updateAudioUI(b)}}function updateAudioUI(a){if(document.getElementById("audio-div")==null){return}if(a!=null&&a!=undefined){document.getElementById("audio-background").style.backgroundImage="url("+a.thumbnail_url+"), url(ccjs/images/default_audio_thumb.png)";document.getElementById("audio-teewe-logo").style.backgroundImage="url(ccjs/images/teewe_logo_pause.png)";document.getElementById("audio-subtitle-icon").style.backgroundImage="url(ccjs/images/device_icon.png)";document.getElementById("audio-thumbnail-div").style.backgroundImage="url("+a.thumbnail_url+"), url(ccjs/images/default_audio_thumb.png)";document.getElementById("audio-title-text").innerHTML=a.title;document.getElementById("audio-album-text").innerHTML=a.album_name==undefined?"Unknown Album":a.album_name;document.getElementById("audio-artist-text").innerHTML=a.artist_name==undefined?"Unknown Artist":a.artist_name;document.getElementById("audio-subtitle-text").innerHTML=a.source;updateAudioState(STATE_LOADING);updateProgressDiv(0,0)}}function updateAudioState(b){if(document.getElementById("audio-div")==null){return}var d="ccjs/images/pause_state_icon.png";var a="ccjs/images/loader_png.png";var c=document.getElementById("audio-thumbnail-state");switch(b){case STATE_PLAYING:c.style.display="none";break;case STATE_PAUSED:c.style.display="block";if(c.style.backgroundImage.indexOf(d)==-1){c.style.backgroundImage="url("+d+")"}break;case STATE_LOADING:c.style.display="block";if(c.style.backgroundImage.indexOf(a)==-1){c.style.backgroundImage="url("+a+")"}break}}function hideAudioUI(){if(document.getElementById("audio-div")!=null){$("#audio-div").remove()}}function hideLoadingUI(a){if(document.getElementById("video-div")!=null){if(a){$("#video-div").fadeOut(1000,function(){$("#video-div").remove()})}else{$("#video-div").remove()}}}function showSeekUI(a,b,d){if(globalCurrentMedia!=null&&globalCurrentMedia.type==AUDIO_TYPE){return}var c=getProgressbarDiv();$("#container").append(c);$("#progress-div").css("z-index","3");$("#progress-div").css("padding-left","40px");updateProgressDiv(b,d);setTimeout(function(){hideSeekUI(true)},2000)}function hideSeekUI(a){if(a){$("#progress-div").fadeOut(1000,function(){$("#progress-div").remove()})}else{$("#progress-div").remove()}}function getProgressbarDiv(){var a=document.getElementById("progress-div");if(a==null){a=$('<div id="progress-div" </div>').append('<p id="current-time-text">00:00:00</p>').append('<progress id="progress-bar" max="100" value="0">></progress>').append('<p id="total-duration-text">00:00:00</p>');return a}else{return a}}function updateProgressDiv(d,f){var a=d;var e=f;var c=0;if(e!=0){c=(100*a)/e}var b=document.getElementById("progress-div");if(b!=null){$("#current-time-text").html(convertTime(a));$("#total-duration-text").html(convertTime(e));$("#progress-bar").val(c)}}function showPauseScreen(c,d,e){if(c.type==AUDIO_TYPE){return}var b=document.getElementById("pause-div");if(b==null){log("current position : "+d);log("duration  : "+e);var a=$('<div id="metadata-div"><div id = "meta-thumbnail-div"><div id = "meta-state-icon"></div></div><div id = "meta-title-div"><p id = "meta-title-text"></p><div id = "meta-subtitle-div"><div id = "meta-subtitle-icon"></div><p id = "meta-subtitle-text"></p><div id = "meta-teewe-logo"></div></div></div></div>');b=$('<div id = "pause-div"></div>').append(a).append(getProgressbarDiv());$("#container").append(b);updatePauseScreen(c,d,e);updateProgressDiv(d,e)}else{updatePauseScreen(c,d,e)}}function updatePauseScreen(a,b,c){document.getElementById("meta-state-icon").style.backgroundImage="url(ccjs/images/pause_state_icon.png)";document.getElementById("meta-teewe-logo").style.backgroundImage="url(ccjs/images/teewe_logo_pause.png)";document.getElementById("meta-thumbnail-div").style.backgroundImage="url("+a.thumbnail_url+"), url(ccjs/images/default_video_thumb.png)";document.getElementById("meta-title-text").innerHTML=a.title;document.getElementById("meta-subtitle-text").innerHTML=a.source;switch(a.type){case YOUTUBE_TYPE:document.getElementById("meta-subtitle-icon").style.backgroundImage="url(ccjs/images/yt_icon.png)";break;case VIDEO_TYPE:document.getElementById("meta-subtitle-icon").style.backgroundImage="url(ccjs/images/device_icon.png)";break}}function hidePauseScreen(a){if(globalCurrentMedia.type==AUDIO_TYPE){return}if(document.getElementById("pause-div")!=null){if(a){$("#pause-div").fadeOut(1000,function(){$("#pause-div").remove()})}else{$("#pause-div").remove()}}}function stopAndGotoHome(){hidePauseScreen(false);hideAudioUI();hideSeekUI(false);hideLoadingUI(false);hideYoutubeError();hideVideoAudioError()}function convertTime(b){var a=Math.floor(b/3600);var c=Math.floor((b-(a*3600))/60);var e=b-(a*3600)-(c*60);if(a<10){a="0"+a}if(c<10){c="0"+c}if(e<10){e="0"+e}var d=a+":"+c+":"+e;return d}function showYoutubeError(){if(document.getElementById("youtube-error-div")==null){var a="Oops!";var c="The uploader has restricted playback on platforms other than YouTube.com";var b=$('<div id="youtube-error-div"><p id="yt-error-title-text"></p><p id="yt-error-description-text"></p></div>');$("#container").append(b);$("#yt-error-title-text").text(a);$("#yt-error-description-text").text(c)}}function hideYoutubeError(){if(document.getElementById("youtube-error-div")!=null){$("#youtube-error-div").remove()}}function showVideoAudioError(){if(document.getElementById("media-error-div")==null){var b="Oops!";var c="This media cannot be played on this device.";var a="This may be because: <br><br>1. The video codec is not supported <br>2. You are having trouble with your WiFi network";var d=$('<div id="media-error-div"><p id="media-error-title-text"></p><p id="media-error-description-text"></p><p id="media-error-footer-text"></p></div>');$("#container").append(d);$("#media-error-title-text").text(b);$("#media-error-description-text").text(c);$("#media-error-footer-text").html(a)}}function hideVideoAudioError(){if(document.getElementById("media-error-div")!=null){$("#media-error-div").remove()}}var teeweVideoPlayer;var VideoSingleton=(function(){var u;var q;var p=false;var s=false;function n(){var w=new l();return w}function l(){this.loadPlayer=d;this.loadVideo=j;this.pause=h;this.play=v;this.stop=f;this.seek=b;this.getCurrentPosition=o;this.duration=m}function d(){var w=document.getElementById("container");if(document.getElementById("video-player")==null){q=document.createElement("video");q.id="video-player";q.className="videoPlayer";q.autoPlay=true;q.preload="auto";w.appendChild(q);showLoadingUI(globalCurrentMedia);g()}else{log("Video player already loaded");g()}}function j(w){if(p){showLoadingUI(w);s=false;q.src=w.url;q.onplaying=r;q.onseeking=k;q.onwaiting=c;q.onended=t;q.onpause=e;q.onerror=i;q.play();log(q.canPlayType("video/x-msvideo"))}else{d()}}function g(){p=true;setCurrentMediaplayer(VIDEO_PLAYER);log("Video player is ready to play");if(globalCurrentMedia!=null){teeweVideoPlayer.loadVideo(globalCurrentMedia)}}function h(){if(q!=null){q.pause()}showPauseScreen(globalCurrentMedia,getCurrentPositionInSeconds(),getTotalDurationInSeconds())}function v(){if(q!=null){q.play()}hidePauseScreen(true)}function f(){if(q!=null){s=true;q.removeAttribute("src");delete (q);document.getElementById("container").removeChild(document.getElementById("video-player"));p=false;q=null;stopAndGotoHome();a()}}function b(w){showSeekUI(globalCurrentMedia,w,getTotalDurationInSeconds());if(q!=null){q.currentTime=w}}function o(){if(q==null){return 0}var w=q.currentTime;if(isNaN(w)){return 0}else{return w}}function m(){if(q==null){return 0}var w=q.duration;if(isNaN(w)){return 0}else{return w}}function c(){setAndBroadcastPlayerState(STATE_LOADING)}function r(){setAndBroadcastPlayerState(STATE_PLAYING);hideLoadingUI(false)}function t(){setAndBroadcastPlayerState(STATE_STOPPED);playbackEnded()}function a(){setAndBroadcastPlayerState(STATE_STOPPED)}function e(){if(!s){setAndBroadcastPlayerState(STATE_PAUSED)}}function i(w){var x=w.target.error.code;logError("Error code : "+x);hideLoadingUI(false);showVideoAudioError();errorTimeout=setTimeout(function(){t()},8000)}function k(){setAndBroadcastPlayerState(STATE_LOADING)}return{getInstance:function(){if(!u){u=n()}return u}}})();teeweVideoPlayer=VideoSingleton.getInstance();var teeweYoutubePlayer;var youtubePlayerReady=false;var youtubePlayer;var destroyPlayer=false;var youtubeDefaultQuality="default";var YoutubeSingleton=(function(){var k;function i(){var o=new j();return o}function j(){this.loadPlayer=a;this.loadVideo=c;this.play=e;this.pause=m;this.stop=h;this.seek=b;this.getCurrentPosition=n;this.duration=f;this.destroyPlayer=d}function a(){setAndBroadcastPlayerState(STATE_LOADING);destroyPlayer=false;var q=document.createElement("div");q.id="youtube-player";q.className="ytplayer";document.getElementById("container").appendChild(q);if(document.getElementById("youtube-script-id")==null){var o=document.createElement("script");o.id="youtube-script-id";o.src="https://www.youtube.com/iframe_api";var p=document.getElementById("youtube-player");p.parentNode.insertBefore(o,p)}else{var o=document.getElementById("youtube-script-id");var p=document.getElementById("youtube-player");p.parentNode.insertBefore(o,p);onYouTubeIframeAPIReady()}log("iframe created")}function m(){showPauseScreen(globalCurrentMedia,getCurrentPositionInSeconds(),getTotalDurationInSeconds());if(youtubePlayer!=null){youtubePlayer.pauseVideo()}}function e(){hidePauseScreen(true);if(youtubePlayer!=null){youtubePlayer.playVideo()}}function b(o){showSeekUI(globalCurrentMedia,o,getTotalDurationInSeconds());if(youtubePlayer!=null){youtubePlayer.seekTo(o,true)}}function n(){if(youtubePlayer==null){return 0}var o=youtubePlayer.getCurrentTime();if(isNaN(o)){return 0}else{return o}}function f(){if(youtubePlayer==null){return 0}var o=youtubePlayer.getDuration();if(isNaN(o)){return 0}else{return o}}function d(){youtubePlayer.destroy();document.getElementById("container").removeChild(document.getElementById("youtube-player"));destroyPlayer=false;youtubePlayerReady=false}function c(o){if(youtubePlayerReady){log("youtube player is loaded. starting to play videoid : "+o.video_id);youtubePlayer.loadVideoById(o.video_id,0,youtubeDefaultQuality)}else{log("Youtube Player is not ready");a()}showLoadingUI(o)}function h(){stopAndGotoHome();log("Stopping video and killing youtube player");if(youtubePlayer.getPlayerState()==-1){d()}else{destroyPlayer=true;youtubePlayer.stopVideo()}}function g(p){var o=["small","medium","large","hd720","highres","hd1080","default"];if(o.indexOf(p)!=-1){youtubeDefaultQuality=p}else{youtubeDefaultQuality="default"}youtubePlayer.setPlaybackQuality(youtubeDefaultQuality)}function l(){return youtubePlayer.getPlaybackQuality()}return{getInstance:function(){if(!k){k=i()}return k}}})();teeweYoutubePlayer=YoutubeSingleton.getInstance();function onYouTubeIframeAPIReady(){log("iFrame player is ready");youtubePlayer=new YT.Player("youtube-player",{height:"100%",width:"100%",playerVars:{autoplay:1,controls:0,iv_load_policy:3,rel:0,showinfo:0},events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange,onError:onPlayerError,onPlaybackQualityChange:onQualityChange}})}function onPlayerReady(a){log("Player Ready called");setCurrentMediaplayer(YOUTUBE_PLAYER);youtubePlayerReady=true;if(globalCurrentMedia!=null){youtubePlayer.loadVideoById(globalCurrentMedia.video_id,0,youtubeDefaultQuality)}}function onPlayerStateChange(a){log("Youtube player state : "+a.data);switch(a.data){case -1:log("State: Unstarted");setAndBroadcastPlayerState(STATE_STOPPED);if(destroyPlayer){teeweYoutubePlayer.destroyPlayer()}break;case YT.PlayerState.ENDED:log("State: Playback Ended");setAndBroadcastPlayerState(STATE_STOPPED);playbackEnded();break;case YT.PlayerState.PLAYING:log("State: Playing");setAndBroadcastPlayerState(STATE_PLAYING);hideLoadingUI(false);break;case YT.PlayerState.PAUSED:log("State: Paused");setAndBroadcastPlayerState(STATE_PAUSED);break;case YT.PlayerState.BUFFERING:log("State: Buffering");setAndBroadcastPlayerState(STATE_LOADING);break}}function onPlayerError(a){logError("onPlayerError called : "+a.data);hideLoadingUI(false);if(a.data==150){showYoutubeError()}errorTimeout=setTimeout(function(){playbackEnded()},8000)}function onQualityChange(a){log("Player quality changed :"+a.data);broadcastCurrentYoutubeQuality(a.data)};
